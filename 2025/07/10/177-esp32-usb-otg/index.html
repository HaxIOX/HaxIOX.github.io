<!DOCTYPE html>
<html lang="en" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="å—åŒ—çš„çŒ«" />
  <!-- Open Graph Description ç®€çŸ­æ‘˜è¦-->
  
  <!-- ç”¨äºæœç´¢å¼•æ“çš„æ–‡ç« æ‘˜è¦ -->
  
  
  
  <title>
    
      ESP32-USB-OTG 
      
      
      |
    
     å—åŒ—çš„çŒ«
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- ä»£ç å—é£æ ¼ -->
  
    
<link rel="stylesheet" href="/css/figcaption/mac-block.css">

  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="/plugins/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="/plugins/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script>
  
  
<script src="/js/fancybox.js"></script>


  

  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- å¤´åƒå–æ¶ˆæ‡’åŠ è½½ï¼Œæ·»åŠ no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">Northcat</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">Friends</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- æ–‡ç« è¯¦æƒ…é¡µï¼Œå±•ç¤ºæ–‡ç« å…·ä½“å†…å®¹ï¼Œurlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
<!-- åŒæ—¶ä¸ºã€Œæ ‡ç­¾tagã€ï¼Œã€Œæœ‹å‹friendã€ï¼Œã€Œåˆ†ç±»categoriesã€ï¼Œã€Œå…³äºaboutã€é¡µé¢çš„æ‰¿è½½é¡µé¢ï¼Œå…·ä½“å±•ç¤ºå–å†³äºpage.type -->


  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="/plugins/clipboard.min.js"></script>
  
  
<script src="/js/codeCopy.js"></script>







  

  

  

  
  <!-- æ–‡ç« å†…å®¹é¡µ urlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">ESP32-USB-OTG</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
          2025-10-06 22:51:28
        </span>
        
              <span class="post-tags">
                <i class="iconfont icon-tags mr-10" title="Tags"></i>
                
                <span class="span--tag mr-8">
                  <a href="/tags/ESP32/" title="ESP32">
                    #ESP32
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æˆ‘éœ€è¦ä½¿ç”¨ESP32ä½œä¸ºä¸»æœºæ¥å—USB CDCè®¾å¤‡çš„æ•°æ®å¹¶è½¬å‘æ‰“å°å‡ºæ¥</p>
<h1 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h1><ul>
<li><a target="_blank" rel="noopener" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32s3/api-reference/peripherals/usb_host.html">USB Host - ESP32-S3 - â€” ESP-IDF ç¼–ç¨‹æŒ‡å— latest æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/espressif/esp-idf/tree/5b11d5b2/examples/peripherals/usb/host/cdc/cdc_acm_host">esp-idf&#x2F;examples&#x2F;peripherals&#x2F;usb&#x2F;host&#x2F;cdc&#x2F;cdc_acm_host at 5b11d5b26a8bf151fc6bac400158859eedd413bc Â· espressif&#x2F;esp-idf</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-reference/peripherals/usb_host.html#id15">USB ä¸»æœº - ESP32-S3 - â€” ESP-IDF ç¼–ç¨‹æŒ‡å— latest æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/espressif/esp-idf/tree/5b11d5b26a8bf151fc6bac400158859eedd413bc/examples/peripherals/usb/host/cdc/cdc_acm_vcp/main">esp-idf&#x2F;examples&#x2F;peripherals&#x2F;usb&#x2F;host&#x2F;cdc&#x2F;cdc_acm_vcp&#x2F;main at 5b11d5b26a8bf151fc6bac400158859eedd413bc Â· espressif&#x2F;esp-idf</a></li>
<li><a target="_blank" rel="noopener" href="https://esphome.io/components/usb_uart.html">USB UART Interface â€” ESPHome</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.espressif.com/projects/esp-iot-solution/zh_CN/latest/usb/usb_overview/usb_otg.html">USB-OTG å¤–è®¾ä»‹ç» - - â€” ESP-IoT-Solution latest æ–‡æ¡£</a></li>
</ul>
<h1 id="å¿ƒè·¯å†ç¨‹"><a href="#å¿ƒè·¯å†ç¨‹" class="headerlink" title="å¿ƒè·¯å†ç¨‹"></a>å¿ƒè·¯å†ç¨‹</h1><p>è€æ¿å„¿ä¸‹å‘éœ€è¦ä½¿ç”¨ESP32åšä¸»æœºæ¥æ”¶ä¸€æ¬¾æ— çº¿ç”µé¢‘è°±æ¢æµ‹è®¾å¤‡<code>usbæ¨¡æ‹Ÿä¸²å£</code>çš„æ•°æ®ï¼Œæˆ‘é»˜è®¤usbæ¨¡æ‹Ÿä¸²å£å°±æ˜¯USB_CDCè§„èŒƒçš„,ç„¶ååˆå› ä¸ºESP32S3è¿™ä¸ªèŠ¯ç‰‡æ˜¯æ”¯æŒUSB_OTGçš„ï¼Œæ‰€ä»¥æˆ‘åˆé»˜è®¤æ‰‹é‡Œè¿™å—æ¿å­æ”¯æŒäº†ã€‚</p>
<p>æˆ‘çœ‹äº†æ¿å­çš„æ–‡æ¡£ï¼Œä½†æ˜¯æˆ‘è¯¯ä»¥ä¸ºè¿™å¥è¯æ˜¯æœ‰OTGåŠŸèƒ½çš„æ„æ€</p>
<img src="/2025/07/10/177-esp32-usb-otg/1752481676321.png" class="" width="1752481676321">

<p>å› ä¸ºæ‰‹å¤´çš„ESP32S3åªæœ‰ä¸€ä¸ªType-cçš„å¤´ï¼ˆåˆçœ‹äº†åŸç†å›¾ï¼Œä¸èƒ½åå‘ä¾›ç”µï¼‰ï¼Œæ‰€ä»¥æˆ‘è¿›è¡Œäº†å•ç‹¬ä¾›ç”µï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œã€‚ç„¶åæ–°æ¿å­åˆ°äº†ï¼ˆè¿˜å¥½ä¹°äº†æ–°æ¿å­ï¼‰ï¼Œè¿æ¥æµ‹è¯•deviceè®¾å¤‡æˆåŠŸï¼Œæ‰“å°äº†ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯æ— çº¿ç”µé¢‘è°±é‚£å—æ¿å­è¿˜æ˜¯ä¸è¡Œ,å› ä¸ºæ˜¯CH340EèŠ¯ç‰‡ã€‚</p>
<p>AIè€å¸ˆè¯´:â€™â€™è¿™ä¸ªèŠ¯ç‰‡ä¸æ˜¯æ ‡å‡†çš„CDCè§„èŒƒâ€™â€™</p>
<p><code>CH340E ä¸éµå¾ªæ ‡å‡† CDC ACM ç±»å®šä¹‰ï¼ˆå®ƒæ˜¯å‚å•†è‡ªå®šä¹‰ç±» Class 0xFFï¼‰</code></p>
<p>æ”¹äº†å‡ ç‰ˆéƒ½æœ‰æ¯›ç—…,åˆå»çœ‹æ–‡æ¡£äº†,å‘ç°æœ‰ä¸€ä¸ªä¾‹ç¨‹æ”¯æŒCH34Xçš„(ESPè¿˜æ˜¯å¤ªå…¨é¢äº†)çƒ§å½•åæˆåŠŸäº†ã€‚</p>
<h1 id="è™šæ‹Ÿä¸²å£"><a href="#è™šæ‹Ÿä¸²å£" class="headerlink" title="è™šæ‹Ÿä¸²å£"></a>è™šæ‹Ÿä¸²å£</h1><p>USB è™šæ‹Ÿä¸²å£ï¼ˆVirtual COM Portï¼‰æŒ‡çš„æ˜¯ï¼šåœ¨ USB æ€»çº¿ä¸Šæ¨¡æ‹Ÿå‡ºä¸€ä¸ªä¼ ç»Ÿçš„ä¸²å£ï¼ˆUART&#x2F;RS-232ï¼‰æ¥å£ï¼Œè®©ä¸»æœºç³»ç»ŸæŠŠå®ƒå½“æˆä¸€ä¸ªâ€œä¸²å£è®¾å¤‡â€æ¥é©±åŠ¨å’Œä½¿ç”¨ï¼Œç”¨æˆ·åœ¨æ“ä½œç³»ç»Ÿé‡Œä¼šçœ‹åˆ°ä¸€ä¸ª COM ç«¯å£ï¼ˆWindows ä¸‹å¦‚ COM3ï¼ŒLinux ä¸‹å¦‚ &#x2F;dev&#x2F;ttyUSB0ï¼‰ã€‚</p>
<h2 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h2><ol>
<li><strong>USB CDC-ACM ç±»</strong><br> USB å®šä¹‰äº†ä¸€ç§ â€œCDC-ACMâ€ï¼ˆCommunications Device Class &amp; Abstract Control Modelï¼‰åè®®ï¼Œå®ƒä¸“é—¨ç”¨æ¥åœ¨ USB ä¸Šä¼ è¾“â€œä¸²å£â€æ•°æ®ï¼Œå¹¶æä¾›è®¾ç½®æ³¢ç‰¹ç‡ã€æ•°æ®ä½ã€æ ¡éªŒä½ã€æµæ§ç­‰æ§åˆ¶å‘½ä»¤ã€‚åªè¦è®¾å¤‡å£°æ˜è‡ªå·±æ”¯æŒ CDC-ACM ç±»ï¼Œä¸»æœºå°±ä¼šåŠ è½½æ ‡å‡†çš„ USB ä¸²å£é©±åŠ¨ï¼ŒæŠŠå®ƒå½“æˆä¸²å£æ¥ç”¨ã€‚</li>
<li><strong>ç¡¬ä»¶è½¬æ¢å™¨èŠ¯ç‰‡</strong><br> åƒ FT232Rã€CP2102ã€CH340E è¿™äº› USB è½¬ä¸²å£èŠ¯ç‰‡ï¼Œå†…éƒ¨åŒæ—¶å®ç°äº†ï¼š<ul>
<li>ä¸€ç«¯æ˜¯ <strong>USB PHY + USB åè®®æ ˆ</strong>ï¼Œä¸ä¸»æœºäº¤æ¢ USB åŒ…ï¼›</li>
<li>å¦ä¸€ç«¯æ˜¯ <strong>TTL çº§åˆ«çš„ UART</strong>ï¼ˆå³é€»è¾‘ç”µå¹³ 3.3V&#x2F;5V çš„ RX&#x2F;TX å£ï¼‰ï¼›<br> å®ƒæŠŠ USB æ”¶åˆ°çš„æ•°æ®è§£åŒ…æˆ UART RX æµï¼Œä¹ŸæŠŠä» UART TX æ”¶åˆ°çš„æ•°æ®æ‰“åŒ…æˆ USB åŒ…ï¼Œå†å‘ç»™ä¸»æœºã€‚</li>
</ul>
</li>
</ol>
<h1 id="USB-OTG"><a href="#USB-OTG" class="headerlink" title="USB OTG"></a>USB OTG</h1><p><strong>USB OTG (On-The-Go)</strong> æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ <strong>USB åŠŸèƒ½çš„è§„èŒƒ</strong>ï¼Œå®ƒèµ‹äºˆäº† USB ç«¯å£<strong>è§’è‰²åŠ¨æ€åˆ‡æ¢çš„èƒ½åŠ›</strong>ã€‚</p>
<ul>
<li><strong>ä¸æ˜¯ä¸€ä¸ªé€šä¿¡åè®®æœ¬èº«ï¼š</strong> USB OTG è‡ªèº«ä¸å®šä¹‰å¦‚ä½•ä¼ è¾“æ•°æ®ï¼ˆæ¯”å¦‚æ•°æ®åŒ…çš„æ ¼å¼ã€æ—¶åºç­‰ï¼‰ï¼Œé‚£äº›æ˜¯ USB 2.0&#x2F;3.0 ç­‰åŸºç¡€ USB åè®®å±‚çš„å·¥ä½œã€‚</li>
<li><strong>ä¸æ˜¯ä¸€ä¸ªç¡¬ä»¶æ¨¡å—ï¼š</strong> è™½ç„¶å®ç° USB OTG åŠŸèƒ½éœ€è¦ç‰¹å®šçš„ç¡¬ä»¶æ”¯æŒï¼ˆæ¯”å¦‚ ESP32-S3 å†…éƒ¨çš„ USB OTG æ§åˆ¶å™¨ï¼‰ï¼Œä½† OTG æœ¬èº«ä¸æ˜¯é‚£ä¸ªç¡¬ä»¶æ¨¡å—ã€‚å®ƒæè¿°çš„æ˜¯ç¡¬ä»¶æ¨¡å—åº”è¯¥å¦‚ä½•è¡¨ç°ï¼Œä»¥åŠè®¾å¤‡ä¹‹é—´å¦‚ä½•åå•†è°æ˜¯ä¸»æœºã€è°æ˜¯è®¾å¤‡ã€‚</li>
<li><strong>å®ƒçš„æ ¸å¿ƒåœ¨äºâ€œè§’è‰²â€ï¼š</strong> ä¼ ç»Ÿçš„ USB åªæœ‰å›ºå®šçš„ä¸»æœºå’Œè®¾å¤‡ã€‚OTG æ‰“ç ´äº†è¿™ä¸ªé™åˆ¶ï¼Œè®©ä¸€ä¸ªè®¾å¤‡å¯ä»¥æ ¹æ®éœ€è¦ï¼Œæ—¢èƒ½åšè€å¤§ï¼ˆHostï¼‰ï¼Œä¹Ÿèƒ½åšå°å¼Ÿï¼ˆDeviceï¼‰ã€‚è¿™å°±åƒä¸€ä¸ªäººï¼Œåœ¨å®¶é‡Œå¯ä»¥æ˜¯å®¶é•¿ï¼Œåœ¨å…¬å¸å¯ä»¥æ˜¯å‘˜å·¥ã€‚OTG å®šä¹‰çš„å°±æ˜¯ä»–å¦‚ä½•åœ¨è¿™ä¸¤ä¸ªè§’è‰²ä¹‹é—´åˆ‡æ¢çš„è§„åˆ™ã€‚</li>
</ul>
<blockquote>
<p>åˆ‡æ¢ä¸»ä»è®¾å¤‡çš„ä¸€ç§è§„èŒƒ</p>
</blockquote>
<h1 id="USB-CDC"><a href="#USB-CDC" class="headerlink" title="USB CDC"></a>USB CDC</h1><p><strong>USB CDC (Communication Device Class)</strong> æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ <strong>USB è®¾å¤‡ç±»å‹æˆ–â€œç±»â€çš„è§„èŒƒ</strong>ã€‚</p>
<ul>
<li><strong>ä¸æ˜¯ä¸€ä¸ªé€šä¿¡åè®®æœ¬èº«ï¼š</strong> CDC ä¸å®šä¹‰åº•å±‚çš„ USB æ•°æ®ä¼ è¾“æ–¹å¼ï¼Œå®ƒæ˜¯åœ¨ USB ä¼ è¾“åè®®ä¹‹ä¸Šï¼Œå®šä¹‰äº†å¦‚ä½•å°†â€œé€šä¿¡è®¾å¤‡â€ï¼ˆæ¯”å¦‚è°ƒåˆ¶è§£è°ƒå™¨ã€ç½‘å¡ï¼Œä»¥åŠæˆ‘ä»¬å¸¸è§çš„è™šæ‹Ÿä¸²å£ï¼‰çš„æ•°æ®å’Œæ§åˆ¶å‘½ä»¤å°è£…æˆ USB åè®®å¯ä»¥è¯†åˆ«çš„æ ¼å¼ã€‚</li>
<li><strong>ä¸æ˜¯ä¸€ä¸ªç¡¬ä»¶æ¨¡å—ï¼š</strong> å°±åƒ OTG ä¸€æ ·ï¼ŒCDC ä¹Ÿéœ€è¦ç¡¬ä»¶æ¥å®ç°ï¼ˆæ¯”å¦‚ä½ è¯´çš„ CH340 èŠ¯ç‰‡ï¼Œæˆ–è€… ESP32-S3 å†…éƒ¨é€šè¿‡å›ºä»¶æ¨¡æ‹Ÿ CDC è®¾å¤‡ï¼‰ã€‚ä½† CDC æœ¬èº«ä¸æ˜¯èŠ¯ç‰‡ï¼Œå®ƒæ˜¯ä¸€ç§â€œè“å›¾â€æˆ–â€œæ ‡å‡†â€ï¼ŒæŒ‡å¯¼èŠ¯ç‰‡å¦‚ä½•å®ç°â€œé€šä¿¡è®¾å¤‡â€çš„åŠŸèƒ½ã€‚</li>
<li><strong>å®ƒçš„æ ¸å¿ƒåœ¨äºâ€œåŠŸèƒ½â€å’Œâ€œæ ‡å‡†åŒ–â€ï¼š</strong> æƒ³è±¡ USB æœ‰å¾ˆå¤šç§â€œè¯­è¨€â€ï¼Œæ¯ç§è¯­è¨€å¯¹åº”ä¸€ç±»è®¾å¤‡ã€‚CDC å°±æ˜¯å…¶ä¸­ä¸€ç§â€œè¯­è¨€â€ï¼Œä¸“é—¨ç”¨æ¥è®© USB è®¾å¤‡æ‰®æ¼”æˆä¸²å£è®¾å¤‡ï¼ˆæˆ–å…¶ä»–é€šä¿¡è®¾å¤‡ï¼‰ã€‚å› ä¸ºæœ‰äº†è¿™ä¸ªæ ‡å‡†ï¼Œæ— è®ºå“ªä¸ªå‚å•†ç”Ÿäº§çš„ USB è™šæ‹Ÿä¸²å£èŠ¯ç‰‡ï¼Œåªè¦éµå¾ª CDC è§„èŒƒï¼Œä¸»æœºï¼ˆå¦‚ç”µè„‘æˆ– ESP32-S3ï¼‰å°±èƒ½ä½¿ç”¨é€šç”¨çš„ CDC é©±åŠ¨æ¥è¯†åˆ«å’Œé€šä¿¡ï¼Œè€Œä¸éœ€è¦ä¸ºæ¯ç§èŠ¯ç‰‡å¼€å‘ä¸“å±é©±åŠ¨ã€‚</li>
</ul>
<hr>
<h3 id="USB-CDC-çš„å®ç°ä½ç½®"><a href="#USB-CDC-çš„å®ç°ä½ç½®" class="headerlink" title="USB CDC çš„å®ç°ä½ç½®"></a>USB CDC çš„å®ç°ä½ç½®</h3><p><strong>USB CDCï¼ˆCommunication Device Classï¼‰åè®®çš„å®ç°æ˜¯åœ¨ USB è®¾å¤‡ï¼ˆä»æœºï¼‰ç«¯ã€‚</strong></p>
<p>ç®€å•æ¥è¯´ï¼Œå½“ä¸€ä¸ªè®¾å¤‡å®£ç§°è‡ªå·±æ˜¯ USB CDC è®¾å¤‡æ—¶ï¼Œå®ƒå†…éƒ¨éœ€è¦æœ‰ä¸€ä¸ªå›ºä»¶ï¼ˆæˆ–ç¡¬ä»¶èŠ¯ç‰‡ï¼‰èƒ½å¤Ÿï¼š</p>
<ol>
<li><strong>ç†è§£ USB åè®®çš„åº•å±‚é€šä¿¡æœºåˆ¶ã€‚</strong></li>
<li><strong>æŒ‰ç…§ CDC è§„èŒƒæ¥å°è£…å’Œè§£å°è£…æ•°æ®ã€‚</strong> ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒè¦æŠŠè‡ªå·±å†…éƒ¨çš„æ•°æ®ï¼ˆæ¯”å¦‚ä¼ æ„Ÿå™¨è¯»æ•°ã€å¾®æ§åˆ¶å™¨äº§ç”Ÿçš„è°ƒè¯•ä¿¡æ¯ï¼‰ä¼ªè£…æˆä¸²å£æ•°æ®ï¼Œç„¶åé€šè¿‡ USB åè®®å‘é€å‡ºå»ã€‚</li>
</ol>
<p>æ¯”å¦‚ä½ è¯´çš„ CH340ã€CP2102ã€FT232R è¿™äº›èŠ¯ç‰‡ï¼Œå®ƒä»¬ä¹‹æ‰€ä»¥èƒ½â€œæ¨¡æ‹Ÿä¸²å£â€ï¼Œå°±æ˜¯å› ä¸ºå®ƒä»¬å†…éƒ¨é›†æˆäº† USB æ§åˆ¶å™¨å’Œé¢„çƒ§å½•çš„å›ºä»¶ï¼Œè¿™äº›å›ºä»¶å®Œå…¨å®ç°äº† <code>USB CDC åè®®</code>ã€‚å®ƒä»¬è¿æ¥åˆ°ç”µè„‘åï¼Œç”µè„‘ä¸€çœ‹ï¼šâ€œå“¦ï¼Œè¿™æ˜¯ä¸€ä¸ª CDC è®¾å¤‡ï¼Œæˆ‘å¯ä»¥ç”¨æˆ‘ç³»ç»Ÿè‡ªå¸¦çš„è™šæ‹Ÿä¸²å£é©±åŠ¨æ¥å’Œå®ƒé€šä¿¡ã€‚â€</p>
<h3 id="ç”µè„‘ç«¯çš„ä½œç”¨ï¼šæä¾›é©±åŠ¨"><a href="#ç”µè„‘ç«¯çš„ä½œç”¨ï¼šæä¾›é©±åŠ¨" class="headerlink" title="ç”µè„‘ç«¯çš„ä½œç”¨ï¼šæä¾›é©±åŠ¨"></a>ç”µè„‘ç«¯çš„ä½œç”¨ï¼šæä¾›é©±åŠ¨</h3><p>ç”µè„‘ç«¯ï¼ˆæˆ–è€…åƒ ESP32-S3 è¿™æ ·çš„ USB ä¸»æœºï¼‰ä¸éœ€è¦â€œå¼€å¯ CDCâ€ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼š</p>
<ol>
<li><strong>ä½œä¸º USB ä¸»æœºï¼š</strong> æä¾› USB ç«¯å£å¹¶è´Ÿè´£æšä¸¾å’Œç®¡ç†è¿æ¥çš„ USB è®¾å¤‡ã€‚</li>
<li><strong>æä¾› CDC ä¸»æœºé©±åŠ¨ï¼š</strong> å½“ç”µè„‘è¯†åˆ«åˆ°ä¸€ä¸ª USB CDC è®¾å¤‡æ—¶ï¼Œå®ƒä¼šåŠ è½½ç›¸åº”çš„ <strong>USB CDC ä¸»æœºé©±åŠ¨</strong>ï¼ˆé€šå¸¸æ“ä½œç³»ç»Ÿè‡ªå¸¦ï¼‰ã€‚è¿™ä¸ªé©±åŠ¨å°±åƒä¸€ä¸ªâ€œç¿»è¯‘å®˜â€ï¼Œå®ƒè´Ÿè´£ï¼š<ul>
<li><strong>å°†æ¥è‡ª CDC è®¾å¤‡çš„æ•°æ®åŒ…è§£åŒ…ï¼Œå¹¶å°†å…¶å‘ˆç°ä¸ºè™šæ‹Ÿä¸²å£çš„æ•°æ®æµã€‚</strong> è¿™æ ·ï¼Œä½ çš„ä¸²å£è°ƒè¯•åŠ©æ‰‹æˆ–åº”ç”¨ç¨‹åºå°±èƒ½åƒæ“ä½œçœŸå®ä¸²å£ä¸€æ ·æ¥è¯»å†™æ•°æ®ã€‚</li>
<li><strong>å°†ä½ çš„åº”ç”¨ç¨‹åºå‘é€çš„ä¸²å£æ•°æ®å°è£…æˆ USB æ•°æ®åŒ…ï¼Œå¹¶å‘é€ç»™ CDC è®¾å¤‡ã€‚</strong></li>
</ul>
</li>
</ol>
<p>æ‰€ä»¥ï¼Œ<strong>CDC çš„æ ¸å¿ƒé€»è¾‘å’Œå®ç°æ˜¯åœ¨è®¾å¤‡ç«¯</strong>ï¼Œç”µè„‘ç«¯åªæ˜¯æä¾›äº†ä¸€ä¸ªé€šç”¨çš„é©±åŠ¨æ¥ç†è§£å’Œåˆ©ç”¨è¿™ä¸ª CDC è®¾å¤‡ã€‚</p>
<h3 id="å¼€å‘æ¿å¦‚ä½•å®ç°-CDC"><a href="#å¼€å‘æ¿å¦‚ä½•å®ç°-CDC" class="headerlink" title="å¼€å‘æ¿å¦‚ä½•å®ç° CDC"></a>å¼€å‘æ¿å¦‚ä½•å®ç° CDC</h3><p>å¦‚æœåˆ«çš„å¼€å‘æ¿ï¼ˆæ¯”å¦‚åŸºäº STM32ã€GD32 ç­‰å…¶ä»–å¾®æ§åˆ¶å™¨çš„å¼€å‘æ¿ï¼‰æƒ³è¦é€šè¿‡ USB æ¥å£<strong>æ¨¡æ‹Ÿä¸²å£</strong>ï¼ˆæˆä¸ºä¸€ä¸ª USB CDC è®¾å¤‡ï¼‰ï¼Œå®ƒä»¬é€šå¸¸ä¼šè¿™ä¹ˆåšï¼š</p>
<ol>
<li><strong>ä½¿ç”¨å†…ç½®çš„ USB å¤–è®¾ï¼š</strong> å¾ˆå¤šå¾®æ§åˆ¶å™¨éƒ½å†…ç½®äº† USB æ§åˆ¶å™¨ï¼ˆFull-speed æˆ– High-speedï¼‰ã€‚</li>
<li><strong>åœ¨å›ºä»¶ä¸­å®ç° USB CDC åè®®æ ˆï¼š</strong> å¼€å‘è€…éœ€è¦åœ¨å¾®æ§åˆ¶å™¨çš„å›ºä»¶ä¸­ç¼–å†™ä»£ç ï¼Œå®ç° USB CDC åè®®æ ˆã€‚è¿™åŒ…æ‹¬ï¼š<ul>
<li>USB æè¿°ç¬¦ï¼ˆå‘Šè¯‰ä¸»æœºæˆ‘æ˜¯è°ï¼Œæˆ‘æ˜¯ CDC è®¾å¤‡ï¼‰ã€‚</li>
<li>æ•°æ®ç«¯ç‚¹çš„é…ç½®ï¼ˆIN&#x2F;OUT ç«¯ç‚¹ç”¨äºæ•°æ®ä¼ è¾“ï¼‰ã€‚</li>
<li>CDC ç±»çš„å…·ä½“å®ç°ï¼ˆå¦‚ä½•å¤„ç†ä¸²è¡Œæ•°æ®æµå’Œæ§åˆ¶å‘½ä»¤ï¼‰ã€‚</li>
<li>ä¸­æ–­æœåŠ¡ç¨‹åºï¼ˆå¤„ç† USB äº‹ä»¶ï¼‰ã€‚ è¿™äº›å·¥ä½œé€šå¸¸ä¼šä½¿ç”¨å¾®æ§åˆ¶å™¨å‚å•†æä¾›çš„ USB åº“æˆ–ç¬¬ä¸‰æ–¹çš„ USB åè®®æ ˆï¼ˆå¦‚ TinyUSBï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 id="ä¸ºä»€ä¹ˆ-ESP32-S3-ä½œä¸ºä¸»æœºæ—¶ä¸éœ€è¦-CDC"><a href="#ä¸ºä»€ä¹ˆ-ESP32-S3-ä½œä¸ºä¸»æœºæ—¶ä¸éœ€è¦-CDC" class="headerlink" title="ä¸ºä»€ä¹ˆ ESP32-S3 ä½œä¸ºä¸»æœºæ—¶ä¸éœ€è¦ CDC"></a>ä¸ºä»€ä¹ˆ ESP32-S3 ä½œä¸ºä¸»æœºæ—¶ä¸éœ€è¦ CDC</h3><ul>
<li><strong>CDC æ˜¯è®¾å¤‡ç«¯çš„èƒ½åŠ›</strong>ï¼Œè®©è®¾å¤‡èƒ½ä¼ªè£…æˆä¸²å£ã€‚</li>
<li><strong>USB ä¸»æœºéœ€è¦ CDC é©±åŠ¨</strong>ï¼Œæ‰èƒ½å’Œè¿™äº› CDC è®¾å¤‡é€šä¿¡ã€‚</li>
</ul>
<h2 id="æ€»ç»“æœ¬è´¨ï¼š"><a href="#æ€»ç»“æœ¬è´¨ï¼š" class="headerlink" title="æ€»ç»“æœ¬è´¨ï¼š"></a>æ€»ç»“æœ¬è´¨ï¼š</h2><ul>
<li><strong>USB OTG çš„æœ¬è´¨æ˜¯ï¼š</strong> USB ç«¯å£<strong>è§’è‰²åŠ¨æ€åˆ‡æ¢çš„è§„èŒƒ</strong>ã€‚å®ƒè§£å†³äº†â€œè°æ˜¯è€å¤§â€çš„é—®é¢˜ï¼Œè®©è®¾å¤‡å¯ä»¥æ ¹æ®è¿æ¥å¯¹è±¡åŠ¨æ€åˆ‡æ¢ä¸ºâ€œä¸»æœºâ€æˆ–â€œè®¾å¤‡â€ã€‚</li>
<li><strong>USB CDC çš„æœ¬è´¨æ˜¯ï¼š</strong> ä¸€ç§ <strong>USB è®¾å¤‡ç±»åˆ«è§„èŒƒ</strong>ï¼Œç”¨äºå®šä¹‰å¦‚ä½•é€šè¿‡ USB æ¥å£æ¥<strong>æ¨¡æ‹Ÿä¼ ç»Ÿä¸²è¡Œé€šä¿¡</strong>åŠŸèƒ½ã€‚å®ƒè§£å†³äº†â€œæ€ä¹ˆé€šä¿¡â€ï¼ˆä»¥ä¸²å£å½¢å¼ï¼‰çš„é—®é¢˜ã€‚</li>
</ul>
<p>ä¸¤è€…ç¼ºä¸€ä¸å¯ã€‚ä½ çš„ ESP32-S3 å¿…é¡»å…·å¤‡ <strong>OTG èƒ½åŠ›</strong>å¹¶æ‰®æ¼”<strong>ä¸»æœºè§’è‰²</strong>ï¼Œæ‰èƒ½å»è¿æ¥å’Œç®¡ç†é‚£ä¸ª <strong>USB CDC è®¾å¤‡</strong>ï¼Œè¿›è€Œè§£æå®ƒå‘é€çš„æ¨¡æ‹Ÿä¸²å£æ•°æ®ã€‚</p>
<h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><h2 id="ä»æœºç«¯"><a href="#ä»æœºç«¯" class="headerlink" title="ä»æœºç«¯"></a>ä»æœºç«¯</h2><p>â€¦</p>
<h2 id="ä¸»æœºç«¯"><a href="#ä¸»æœºç«¯" class="headerlink" title="ä¸»æœºç«¯"></a>ä¸»æœºç«¯</h2><p><a target="_blank" rel="noopener" href="https://github.com/espressif/esp-idf/tree/5b11d5b26a8bf151fc6bac400158859eedd413bc/examples/peripherals/usb/host/cdc/cdc_acm_vcp/main">ä¾‹ç¨‹</a></p>
<h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p>deviceæ¥ç”µè„‘ç«¯å¯ä»¥æ­£å¸¸è¯†åˆ«åˆ°ï¼Œæ¥hostç«¯è¯†åˆ«ä¸åˆ°</p>
<p>å·²ç»æ’é™¤ï¼š</p>
<ul>
<li><p><input checked="" disabled="" type="checkbox"> 
ä¾›ç”µé—®é¢˜ï¼Œhostä¸deviceåˆ†åˆ«ä¾›ç”µ</p>
</li>
<li><p><input checked="" disabled="" type="checkbox"> 
æ•°æ®çº¿ä¹Ÿå¤šæ¬¡æ›´æ¢è¿‡</p>
</li>
<li><p><input checked="" disabled="" type="checkbox"> 
å¼€å‘æ¿ï¼Œç›®å‰deviceä½¿ç”¨çš„æ˜¯è‡ªåˆ¶çš„æ¿å­</p>
</li>
<li><p><input checked="" disabled="" type="checkbox"> 
âš ï¸Geminiè¯´å¯ä»¥å•ç‹¬ä¾›ç”µï¼Œç»è¿‡æµ‹è¯•å‘ç°å¿…é¡»ç”±ä¸»æœºä¾›ç”µæ‰å¯ä»¥</p>
</li>
<li><p><input checked="" disabled="" type="checkbox"> 
æ£€æŸ¥æ¿å­æ˜¯å¦æ”¯æŒUSB-OT</p>
</li>
<li><p><input disabled="" type="checkbox"> 
ESP32 USB OTGä½œä¸ºhostæ—¶ï¼Œå¿…é¡»è¦ç»™ä»æœºä¾›ç”µæ‰å¯ä»¥é€šä¿¡ï¼ˆ<code>ä¸”å¿…é¡»æ˜¯5V</code>, æ ¹æ® USB 2.0 è§„èŒƒï¼ŒVBUS çš„ç”µå‹èŒƒå›´é€šå¸¸åœ¨ <strong>4.75V åˆ° 5.25V</strong> ä¹‹é—´ï¼ˆå³ 5VÂ±5%ï¼‰ã€‚ï¼‰</p>
<h6 id="ChatGPT-è¯´ï¼š"><a href="#ChatGPT-è¯´ï¼š" class="headerlink" title="ChatGPT è¯´ï¼š"></a>ChatGPT è¯´ï¼š</h6><p>æ˜¯çš„ã€‚æŒ‰ç…§ USB è§„èŒƒï¼Œä»»ä½•ä¸»æœºï¼ˆDFPï¼‰åœ¨ä¸ä»è®¾å¤‡ï¼ˆUFPï¼‰é€šä¿¡å‰ï¼Œéƒ½å¿…é¡»åœ¨ VBUSï¼ˆType-C ä¸Šçš„ 5 V å¼•è„šï¼‰ä¸Šæä¾›ç”µå‹ä¿¡å·ï¼Œå¦åˆ™ä»è®¾å¤‡æ—¢ä¸ä¼šå®Œæˆæšä¸¾ï¼Œä¹Ÿä¸ä¼šå“åº”ä»»ä½•æ•°æ®ä¼ è¾“è¯·æ±‚ã€‚</p>
<ul>
<li><strong>VBUS å­˜åœ¨æ˜¯æšä¸¾çš„å‰æ</strong>ï¼šUSB è®¾å¤‡åœ¨ä¸Šç”µåä¼šæ£€æµ‹åˆ° VBUS çš„ 5 Vï¼Œç„¶åæ‰ä¼šä¸Šæ‹‰ D+ï¼ˆæˆ– Dâ€“ï¼‰ä»¥ç¤ºâ€œå°±ç»ªâ€ï¼Œä¸»æœºæ£€æµ‹åˆ°è¿™ä¸€æ‹‰ç”µé˜»åæ‰ä¼šå¼€å§‹æšä¸¾æµç¨‹ã€‚</li>
<li><strong>å³ä¾¿è®¾å¤‡è‡ªä¾›ç”µï¼Œä¹Ÿéœ€è¦ VBUS</strong>ï¼šè‡ªå¸¦ç”µæºçš„è®¾å¤‡ä¹Ÿå¿…é¡»è®© VBUS ä¿æŒ 5 Vï¼ˆå³ä½¿ä¸ä»ä¸­å¤§ç”µæµè·å–èƒ½é‡ï¼‰ï¼Œå¦åˆ™ä¸»æœº USB æ§åˆ¶å™¨ä¼šè®¤ä¸ºæ²¡æœ‰è®¾å¤‡è¿æ¥ã€‚</li>
<li><strong>Type-C åœºæ™¯ä¸‹</strong>ï¼ŒESP32-S3 ä½œä¸ºä¸»æœºæ—¶ï¼ŒCC å¼•è„šä¸Šçš„ Rp ä¸Šæ‹‰ä¼šå‘Šè¯‰å¯¹ç«¯â€œæˆ‘æ˜¯ä¸»æœºâ€ï¼Œç„¶å ESP32-S3 æ¿ä¸Šçš„ç”µæºå¼€å…³èŠ¯ç‰‡ï¼ç”µè·¯å¿…é¡»ç»™ VBUS æ‰“å¼€ 5 Vã€‚</li>
</ul>
<p>å¦‚æœä½ å‘ç°é€šè¿‡ Type-C å£æ¥ä¸Šä»æ¿å´æ— æ³•é€šä¿¡ï¼Œè¯·å…ˆç”¨ä¸‡ç”¨è¡¨é‡ä¸€ä¸‹ä»æœºé‚£ç«¯çš„ VBUSï¼ˆType-C çš„ VBUS è„šï¼‰æ˜¯å¦çœŸçš„è¢«æ‹‰åˆ° 5 Vï¼›è‹¥æ²¡æœ‰ï¼Œåˆ™éœ€åœ¨ä½ çš„ç¡¬ä»¶è®¾è®¡ä¸­åŠ ä¸€ä¸ª VBUS ç”µæºå¼€å…³æˆ–ç›´æ¥è·³çº¿ç»™å®ƒä¾›ç”µï¼Œæ‰èƒ½è®© USB OTG Host æ­£å¸¸æšä¸¾å¹¶é€šä¿¡ã€‚</p>
</li>
</ul>
<h1 id="CH340"><a href="#CH340" class="headerlink" title="CH340"></a>CH340</h1><p>ä¸‹é¢çš„æ˜¯ç¤ºä¾‹ <a target="_blank" rel="noopener" href="https://github.com/espressif/esp-idf/tree/5b11d5b2/examples/peripherals/usb/host/cdc/cdc_acm_host">peripherals&#x2F;usb&#x2F;host&#x2F;cdc&#x2F;cdc_acm_host</a> æ¥CH340Eçš„æ‰“å°æ•°æ®,æ¥å…¥åHostä¸€ç›´åœ¨é‡å¯</p>
<p>ä½ é‡åˆ°çš„é—®é¢˜æ˜¯ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">D (388) boot: Mapping segment 2 as IROM
D (391) boot: calling set_cache_and_start_app
D (395) boot: configure drom and irom and start
D (400) boot: start: 0x403753d8
--- 0x403753d8: call_start_cpu0 at C:&#x2F;Users&#x2F;VIBTEK&#x2F;esp&#x2F;V5.4.2&#x2F;components&#x2F;esp_system&#x2F;port&#x2F;cpu_start.c:387
I (414) cpu_start: Multicore app
I (423) cpu_start: Pro cpu start user code
I (423) cpu_start: cpu freq: 160000000 Hz
I (423) app_init: Application information:
I (423) app_init: Project name:     cdc_acm_host
I (428) app_init: App version:      1
I (431) app_init: Compile time:     Jul 11 2025 14:44:49
I (436) app_init: ELF file SHA256:  6f037aee3...
I (440) app_init: ESP-IDF:          v5.4.2
I (444) efuse_init: Min chip rev:     v0.0
I (448) efuse_init: Max chip rev:     v0.99 
I (452) efuse_init: Chip rev:         v0.2
I (456) heap_init: Initializing. RAM available for dynamic allocation:
I (462) heap_init: At 3FC96180 len 00053590 (333 KiB): RAM
I (467) heap_init: At 3FCE9710 len 00005724 (21 KiB): RAM
I (472) heap_init: At 3FCF0000 len 00008000 (32 KiB): DRAM
I (478) heap_init: At 600FE01C len 00001FCC (7 KiB): RTCRAM
I (484) spi_flash: detected chip: mxic
I (486) spi_flash: flash io: dio
W (489) spi_flash: Detected size(16384k) larger than the size in the binary image header(2048k). Using the size in the binary image header.
I (502) sleep_gpio: Configure to isolate all GPIO pins in sleep state
I (508) sleep_gpio: Enable automatic switching of GPIO sleep configuration
I (515) main_task: Started on CPU0
I (535) main_task: Calling app_main()
I (535) USB-CDC: Installing USB Host
I (565) USB-CDC: Installing CDC-ACM driver
I (565) USB-CDC: Opening CDC ACM device 0x1A86:0x7523...
*** Device descriptor ***
bLength 18
bDescriptorType 1
bcdUSB 1.10
bDeviceClass 0xff
bDeviceSubClass 0x0
bDeviceProtocol 0x0
bMaxPacketSize0 8
idVendor 0x1a86
idProduct 0x7523
bcdDevice 2.60
iManufacturer 0
iProduct 2
iSerialNumber 0
bNumConfigurations 1
*** Configuration descriptor ***
bLength 9
bDescriptorType 2
wTotalLength 39
bNumInterfaces 1
bConfigurationValue 1
iConfiguration 0
bmAttributes 0x80
bMaxPower 98mA
        *** Interface descriptor ***
        bLength 9
        bDescriptorType 4
        bInterfaceNumber 0
        bAlternateSetting 0
        bNumEndpoints 3
        bInterfaceClass 0xff
        bInterfaceSubClass 0x1
        bInterfaceProtocol 0x2
        iInterface 0
                *** Endpoint descriptor ***
                bLength 7
                bDescriptorType 5
                bEndpointAddress 0x82   EP 2 IN
                bmAttributes 0x2        BULK
                wMaxPacketSize 32
                bInterval 0
                *** Endpoint descriptor ***
                bLength 7
                bDescriptorType 5
                bEndpointAddress 0x2    EP 2 OUT
                bmAttributes 0x2        BULK
                wMaxPacketSize 32
                bInterval 0
                *** Endpoint descriptor ***
                bLength 7
                bDescriptorType 5
                bEndpointAddress 0x81   EP 1 IN
                bmAttributes 0x3        INT
                wMaxPacketSize 8
                bInterval 1
I (1245) USB-CDC: Setting up line coding
E (1245) cdc_acm_ops: cdc_acm_host_line_coding_get(25): line_coding_get function not supported<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="ğŸ§ -é—®é¢˜åˆ†æ"><a href="#ğŸ§ -é—®é¢˜åˆ†æ" class="headerlink" title="ğŸ§  é—®é¢˜åˆ†æ"></a>ğŸ§  é—®é¢˜åˆ†æ</h2><p>ç»“åˆæ—¥å¿—å’Œä»£ç è¡Œä¸ºï¼Œè¯´æ˜ <strong>ESP32-S3 æˆåŠŸæ£€æµ‹åˆ° USB è®¾å¤‡è¿æ¥ï¼ˆå³CH340Eï¼‰ï¼Œä½†æ— æ³•æ‰“å¼€è¯¥è®¾å¤‡è¿›è¡Œ CDC é€šä¿¡</strong>ã€‚è¿™é€šå¸¸æ„å‘³ç€ï¼š</p>
<ol>
<li><strong>è®¾å¤‡æˆåŠŸæšä¸¾ï¼Œä½†ä¸ç¬¦åˆ cdc_acm_host_open() æœŸæœ›çš„ USB æ¥å£ç‰¹å¾ï¼ˆclass&#x2F;subclass&#x2F;protocolï¼‰</strong></li>
<li><strong>CH340E ä¸éµå¾ªæ ‡å‡† CDC ACM ç±»å®šä¹‰ï¼ˆå®ƒæ˜¯å‚å•†è‡ªå®šä¹‰ç±» Class 0xFFï¼‰</strong></li>
<li><strong>ESP-IDF çš„ cdc_acm_host é©±åŠ¨é»˜è®¤åªèƒ½å¤„ç†æ ‡å‡† CDC ACM è®¾å¤‡</strong></li>
<li><strong>ä¸æ˜¯é©±åŠ¨æ— æ³•è¯†åˆ« VID&#x2F;PIDï¼Œè€Œæ˜¯è®¾å¤‡æšä¸¾åå…¶æ¥å£æè¿°ç¬¦ä¸ç¬¦åˆé©±åŠ¨æœŸæœ›</strong></li>
</ol>
<hr>
<h2 id="ğŸ”¬-CH340-ä¸-CDC-ACM-çš„åŒºåˆ«"><a href="#ğŸ”¬-CH340-ä¸-CDC-ACM-çš„åŒºåˆ«" class="headerlink" title="ğŸ”¬  CH340 ä¸ CDC ACM çš„åŒºåˆ«"></a>ğŸ”¬  CH340 ä¸ CDC ACM çš„åŒºåˆ«</h2><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>CH340E</th>
<th>æ ‡å‡† CDC ACM è®¾å¤‡</th>
</tr>
</thead>
<tbody><tr>
<td>USB Class</td>
<td>0xFF (Vendor Specific Class)</td>
<td>0x02 (Communications Device Class)</td>
</tr>
<tr>
<td>Subclass</td>
<td>Varies</td>
<td>0x02 (Abstract Control Model)</td>
</tr>
<tr>
<td>é©±åŠ¨å…¼å®¹æ€§</td>
<td>Windows&#x2F;Linux æœ‰ä¸“ç”¨é©±åŠ¨</td>
<td>ä½¿ç”¨æ ‡å‡† CDC é©±åŠ¨</td>
</tr>
<tr>
<td>ESP-IDF æ”¯æŒ</td>
<td>âŒï¼ˆé»˜è®¤ä¸æ”¯æŒ CH340 ç‰¹æœ‰åè®®ï¼‰</td>
<td>âœ…ï¼ˆESP-IDF <code>cdc_acm_host</code> æ”¯æŒï¼‰</td>
</tr>
</tbody></table>
<p>æ‰€ä»¥è™½ç„¶ä½ æŒ‡å®šäº†æ­£ç¡®çš„ VID&#x2F;PIDï¼ˆ0x1A86:0x7523ï¼‰ï¼Œä½† <code>cdc_acm_host_open()</code> ä¼šæŸ¥éªŒ USB æ¥å£çš„ Class&#x2F;SubClass&#x2F;Protocol å¹¶æ‹’ç»éæ ‡å‡† CDC è®¾å¤‡ â€”â€” <strong>CH340 å°±æ˜¯è¿™ç§æƒ…å†µ</strong>ã€‚</p>
<p>è¿™äº›èŠ¯ç‰‡éƒ½ä¸¥æ ¼éµå¾ª CDC-ACM è§„èŒƒï¼Œå¯ä»¥ç›´æ¥è¢« ESP32-S3 çš„ <code>cdc_acm_host</code> é©±åŠ¨è¯†åˆ«ã€‚</p>
<hr>
<h2 id="ğŸš¨-æ€»ç»“"><a href="#ğŸš¨-æ€»ç»“" class="headerlink" title="ğŸš¨ æ€»ç»“"></a>ğŸš¨ æ€»ç»“</h2><p>ä½ å½“å‰ä¾‹ç¨‹æ— æ³•é€šä¿¡çš„åŸå› éå¸¸æ˜ç¡®ï¼š</p>
<blockquote>
<p>âŒ CH340E å¹¶ä¸ç¬¦åˆæ ‡å‡† CDC ACM ç±»ï¼ŒESP32-S3 çš„ CDC Host é©±åŠ¨æ— æ³•è¯†åˆ«å®ƒï¼Œå³ä½¿ VID&#x2F;PID æ­£ç¡®ã€‚</p>
</blockquote>
<h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><p>è®¨è®º<strong>ç”µæµè´Ÿè½½</strong>æ—¶ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯ <strong>åœ¨è¯¥ç‰¹å®šç”µå‹ä¸‹ï¼Œæ‰€æœ‰è¿æ¥åˆ°è¯¥ç”µå‹è½¨é“çš„è®¾å¤‡æ€»å…±ä¼šæ¶ˆè€—å¤šå°‘ç”µæµ</strong>ã€‚s</p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2025/07/09/176-win10-xiu-gai-you-jian-cai-dan/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>Prev</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
              2025-10-06 22:51:28
            </span>
            
                  <span class="post-tags">
                    <i class="iconfont icon-tags mr-10" title="Tags"></i>
                    
                    <span class="span--tag mr-8">
                      <a href="/tags/ESP32/" title="ESP32">
                        #ESP32
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
              <a href="/2025/07/16/178-tps54627-wen-ya-xin-pian/" target="_self">
                <span>Next</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">Contents</div>
    <div class="catalog-content">
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-text">èƒŒæ™¯</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E6%A1%A3"><span class="toc-text">æ–‡æ¡£</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%83%E8%B7%AF%E5%8E%86%E7%A8%8B"><span class="toc-text">å¿ƒè·¯å†ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E4%B8%B2%E5%8F%A3"><span class="toc-text">è™šæ‹Ÿä¸²å£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">å·¥ä½œåŸç†</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#USB-OTG"><span class="toc-text">USB OTG</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#USB-CDC"><span class="toc-text">USB CDC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#USB-CDC-%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%BD%8D%E7%BD%AE"><span class="toc-text">USB CDC çš„å®ç°ä½ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E8%84%91%E7%AB%AF%E7%9A%84%E4%BD%9C%E7%94%A8%EF%BC%9A%E6%8F%90%E4%BE%9B%E9%A9%B1%E5%8A%A8"><span class="toc-text">ç”µè„‘ç«¯çš„ä½œç”¨ï¼šæä¾›é©±åŠ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%9D%BF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0-CDC"><span class="toc-text">å¼€å‘æ¿å¦‚ä½•å®ç° CDC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88-ESP32-S3-%E4%BD%9C%E4%B8%BA%E4%B8%BB%E6%9C%BA%E6%97%B6%E4%B8%8D%E9%9C%80%E8%A6%81-CDC"><span class="toc-text">ä¸ºä»€ä¹ˆ ESP32-S3 ä½œä¸ºä¸»æœºæ—¶ä¸éœ€è¦ CDC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%E6%9C%AC%E8%B4%A8%EF%BC%9A"><span class="toc-text">æ€»ç»“æœ¬è´¨ï¼š</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-text">é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E6%9C%BA%E7%AB%AF"><span class="toc-text">ä»æœºç«¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E7%AB%AF"><span class="toc-text">ä¸»æœºç«¯</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-text">é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#ChatGPT-%E8%AF%B4%EF%BC%9A"><span class="toc-text">ChatGPT è¯´ï¼š</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CH340"><span class="toc-text">CH340</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A0-%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="toc-text">ğŸ§  é—®é¢˜åˆ†æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%AC-CH340-%E4%B8%8E-CDC-ACM-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">ğŸ”¬  CH340 ä¸ CDC ACM çš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%A8-%E6%80%BB%E7%BB%93"><span class="toc-text">ğŸš¨ æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-text">è¡¥å……</span></a></li></ol>
      
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        







      </div>
    
  </div>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          
              <a title="github" target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">
                <i class="iconfont icon-github"></i>
              </a>
              
        </li>
        
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Copyright Â© 2025 Oranges</a>
        
    </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="Search...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>First search, index file loading, please wait...<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>No result<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The search.xml file was not found, please refer toï¼š<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The request failed, Try to refresh the page or try again later.<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + ESP32-USB-OTG + '&url=' + http%3A%2F%2Fblog.isgeek.top%2F2025%2F07%2F10%2F177-esp32-usb-otg%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=http://blog.isgeek.top/2025/07/10/177-esp32-usb-otg/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  </body>
</html>
